<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Employee Dashboard - QR Inventory System</title>
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="../assets/css/employee-styles.css">
</head>
<body class="dashboard-page">
    <!-- Header -->
    <div class="dashboard-header">
        <div class="header-content">
            <div class="header-left">
                <div class="header-logo">
                    <i class="fas fa-user-tie"></i>
                </div>
                <div class="header-title">
                    <h1>Employee Dashboard</h1>
                    <p>Welcome back, <span id="employee-name">Employee</span></p>
                </div>
            </div>
            <div class="header-right">
                <div class="notification-bell">
                    <i class="fas fa-bell"></i>
                    <span class="notification-badge" id="unread-count" style="display: none;">0</span>
                </div>
                <div class="user-info">
                    <div class="user-avatar" id="user-avatar">E</div>
                </div>
                <button class="logout-btn">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            </div>
        </div>
    </div>

    <!-- Dashboard Content -->
    <div class="dashboard-content">
        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon created">
                    <i class="fas fa-plus-circle"></i>
                </div>
                <div class="stat-info">
                    <h3 id="created-count">0</h3>
                    <p>QR Codes Created Today</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon scanned">
                    <i class="fas fa-qrcode"></i>
                </div>
                <div class="stat-info">
                    <h3 id="scanned-count">0</h3>
                    <p>QR Codes Scanned Today</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon inventory">
                    <i class="fas fa-boxes"></i>
                </div>
                <div class="stat-info">
                    <h3 id="inventory-count">0</h3>
                    <p>Inventory Views Today</p>
                </div>
            </div>
            <div class="stat-card">
                <div class="stat-icon notifications">
                    <i class="fas fa-bell"></i>
                </div>
                <div class="stat-info">
                    <h3 id="notifications-count">0</h3>
                    <p>New Notifications</p>
                </div>
            </div>
        </div>

        <!-- Action Grid -->
        <div class="action-grid">
            <div class="action-card qr-create">
                <div class="action-icon">
                    <i class="fas fa-plus-circle"></i>
                </div>
                <h3>Create QR Code</h3>
                <p>Generate QR codes for new products and add them to the inventory system.</p>
                <button class="action-btn" id="create-qr-btn">
                    <i class="fas fa-plus"></i> Create QR Code
                </button>
            </div>
            <div class="action-card qr-scan">
                <div class="action-icon">
                    <i class="fas fa-qrcode"></i>
                </div>
                <h3>Scan QR Code</h3>
                <p>Scan QR codes to update inventory, track stock movements and manage items.</p>
                <button class="action-btn" id="scan-qr-btn">
                    <i class="fas fa-camera"></i> Scan QR Code
                </button>
            </div>
            <div class="action-card inventory">
                <div class="action-icon">
                    <i class="fas fa-boxes"></i>
                </div>
                <h3>View Inventory</h3>
                <p>Browse and search the complete inventory database to check stock levels.</p>
                <button class="action-btn" id="view-inventory-btn">
                    <i class="fas fa-eye"></i> View Inventory
                </button>
            </div>
        </div>

        <!-- Section Tabs -->
        <div class="section-tabs">
            <button class="tab-btn active" onclick="dashboard.showTab('notifications')">
                <i class="fas fa-bell"></i> Notifications
            </button>
            <button class="tab-btn" onclick="dashboard.showTab('activities')">
                <i class="fas fa-history"></i> Recent Activities
            </button>
        </div>

        <!-- Notifications Tab -->
        <div id="notifications-tab" class="tab-content active">
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">My Notifications</h2>
                </div>
                <div class="notifications-list" id="notifications-list">
                    <!-- Notifications will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Activities Tab -->
        <div id="activities-tab" class="tab-content">
            <div class="section">
                <div class="section-header">
                    <h2 class="section-title">Recent Activities</h2>
                </div>
                <div class="activities-list" id="activities-list">
                    <!-- Activities will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- QR Code Generation Modal (Using iframe like admin) -->
    <div id="qr-modal" class="modal">
        <div class="modal-content modal-xl">
            <div class="modal-header">
                <h2 class="modal-title">Create Product & Generate QR Code</h2>
                <button class="close-btn" onclick="dashboard.closeQRModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <iframe id="product-iframe" src="../components/pages/product-simple.html" 
                        style="width: 100%; height: 600px; border: none;"></iframe>
            </div>
        </div>
    </div>

    <!-- QR Scanner Modal -->
    <div id="scanner-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Scan QR Code</h2>
                <button class="close-btn" onclick="dashboard.closeScannerModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="scanner-container">
                    <div id="scanner-video-container">
                        <video id="scanner-video" style="width: 100%;"></video>
                    </div>
                    <div class="scanner-controls">
                        <button class="btn btn-primary" onclick="dashboard.startScanner()">
                            <i class="fas fa-camera"></i> Start Scanner
                        </button>
                        <button class="btn btn-secondary" onclick="dashboard.stopScanner()">
                            <i class="fas fa-stop"></i> Stop Scanner
                        </button>
                    </div>
                </div>
                <div id="scan-result" style="display: none;">
                    <h3>Scanned Product</h3>
                    <div class="product-info">
                        <p><strong>Product ID:</strong> <span id="scanned-product-id"></span></p>
                        <p><strong>Name:</strong> <span id="scanned-product-name"></span></p>
                        <p><strong>Type:</strong> <span id="scanned-product-type"></span></p>
                        <p><strong>Current Stock:</strong> <span id="scanned-product-stock"></span></p>
                    </div>
                    <div class="stock-update-form">
                        <h4>Update Stock</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Action</label>
                                <select id="stock-action">
                                    <option value="IN">Stock In</option>
                                    <option value="OUT">Stock Out</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Quantity</label>
                                <input type="number" id="stock-quantity" min="1" value="1">
                            </div>
                        </div>
                        <div class="form-group">
                            <label>Notes</label>
                            <textarea id="stock-notes" placeholder="Optional notes..."></textarea>
                        </div>
                        <button class="btn btn-primary" onclick="dashboard.updateStock()">
                            <i class="fas fa-save"></i> Update Stock
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Inventory Modal -->
    <div id="inventory-modal" class="modal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h2 class="modal-title">Inventory Management</h2>
                <button class="close-btn" onclick="dashboard.closeInventoryModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="inventory-filters">
                    <input type="text" id="inventory-search" placeholder="Search products..." 
                           onkeyup="dashboard.filterInventory()">
                    <select id="inventory-type-filter" onchange="dashboard.filterInventory()">
                        <option value="">All Types</option>
                        <option value="Shirt">Shirt</option>
                        <option value="Pant">Pant</option>
                        <option value="Jacket">Jacket</option>
                        <option value="Suit">Suit</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="inventory-table-container">
                    <table class="inventory-table">
                        <thead>
                            <tr>
                                <th>Product ID</th>
                                <th>Name</th>
                                <th>Type</th>
                                <th>Size</th>
                                <th>Color</th>
                                <th>Quantity</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="inventory-list">
                            <!-- Inventory items will be loaded here -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script src="../assets/js/employee-auth.js"></script>
    <script src="../assets/js/employee-dashboard.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.3/build/qrcode.min.js"></script>
    <script src="https://unpkg.com/@zxing/library@latest"></script>
    <script>
        // Initialize dashboard
        const dashboard = new EmployeeDashboard();
        
        document.addEventListener('DOMContentLoaded', function() {
            dashboard.init();
        });

        // Global functions for backward compatibility
        function logout() {
            dashboard.handleLogout();
        }

        function showTab(tabName) {
            dashboard.showTab(tabName);
        }
    </script>
</body>
</html>